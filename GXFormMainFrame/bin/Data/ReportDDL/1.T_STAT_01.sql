IF OBJECT_ID('T_STAT_01_JSHJ')IS NOT NULL DROP VIEW T_STAT_01_JSHJ
GO
CREATE VIEW T_STAT_01_JSHJ AS
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0100' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL <> '0200' AND DL = '0200'
	UNION ALL	
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0110' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL IN ('0111','0112','0113') AND DL NOT IN ('0111','0112','0113')
	UNION ALL	
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0111' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0111' AND DL <>  '0111'	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0113' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0113' AND DL <>  '0113'	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0112' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0112' AND DL <>  '0112'	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0120' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0120' AND DL <>  '0120'	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0130' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL IN ('0131','0132') AND DL NOT IN ('0131','0132')	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0131' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0131' AND DL <>  '0131'	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0132' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0132' AND DL <>  '0132'
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0140' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0140' AND DL <>  '0140'	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0150' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0150' AND DL <>  '0150'	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0160' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0160' AND DL <>  '0160'	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0170' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0170' AND DL <>  '0170'	
	UNION ALL SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0180' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0180' AND DL <>  '0180';
GO
IF OBJECT_ID('T_STAT_01_JS')IS NOT NULL DROP VIEW T_STAT_01_JS
GO
CREATE VIEW T_STAT_01_JS AS 
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  '00' AS LD_QS, MIAN_JI, DI_LEI
	FROM T_STAT_01_JSHJ	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0100' AS DI_LEI
	FROM T_STAT_BH 
	WHERE Q_DL <> '0200' AND DL = '0200'	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0110' AS DI_LEI
	FROM T_STAT_BH 
	WHERE Q_DL IN ('0111','0112','0113') AND DL NOT IN ('0111','0112','0113')	
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0111' AS DI_LEI
	FROM T_STAT_BH 
	WHERE Q_DL = '0111' AND DL <>  '0111' 
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0113' AS DI_LEI
	FROM T_STAT_BH 
	WHERE Q_DL = '0113' AND DL <>  '0113' 
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0112' AS DI_LEI
	FROM T_STAT_BH 
	WHERE Q_DL = '0112' AND DL <>  '0112'
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0120' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0120' AND DL <>  '0120' 
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0130' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL IN ('0131','0132') AND DL NOT IN ('0131','0132') 
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0131' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0131' AND DL <>  '0131' 
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0132' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0132' AND  DL <>  '0132'  
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0140' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0140' AND  DL <>  '0140' 
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0150' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0150' AND  DL <>  '0150' 
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0160' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0160' AND  DL <>  '0160' 
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0170' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0170' AND DL <>  '0170'  
	UNION ALL SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, Q_LD_QS AS LD_QS, MIAN_JI, '0180' AS DI_LEI
	FROM T_STAT_BH WHERE Q_DL = '0180' AND DL <>  '0180' ;
GO
IF OBJECT_ID('T_STAT_01_XZHJ')IS NOT NULL DROP VIEW T_STAT_01_XZHJ
GO
CREATE VIEW T_STAT_01_XZHJ AS 	
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0100' AS DI_LEI
	FROM T_STAT_BH WHERE DL <> '0200' AND Q_DL = '0200'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0110' AS DI_LEI
	FROM T_STAT_BH WHERE DL IN ('0111','0112','0113') AND Q_DL NOT IN ('0111','0112','0113')
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0111' AS DI_LEI
	FROM T_STAT_BH WHERE DL =  '0111' AND Q_DL <> '0111'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0113' AS DI_LEI
	FROM T_STAT_BH WHERE DL =  '0113' AND Q_DL <> '0113'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0112' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0112' AND Q_DL <>  '0112'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0120' AS DI_LEI
	FROM T_STAT_BH WHERE DL ='0120' AND Q_DL <>  '0120'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0130' AS DI_LEI
	FROM T_STAT_BH WHERE DL IN ('0131','0132') AND Q_DL NOT IN ('0131','0132')
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0131' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0131' AND Q_DL <>  '0131'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0132' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0132' AND Q_DL <>  '0132'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0140' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0140' AND Q_DL <>  '0140'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0150' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0150' AND Q_DL <>  '0150'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0160' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0160' AND Q_DL <>  '0160'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0170' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0170' AND Q_DL <>  '0170'
	UNION ALL SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0180' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0180' AND Q_DL <>  '0180';
GO
IF OBJECT_ID('T_STAT_01_XZ')IS NOT NULL DROP VIEW T_STAT_01_XZ
GO
CREATE VIEW T_STAT_01_XZ AS 
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, '00' AS LD_QS, MIAN_JI, DI_LEI
	FROM T_STAT_01_XZHJ
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0100' AS DI_LEI
	FROM T_STAT_BH WHERE DL <> '0200' AND  Q_DL = '0200'  
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0110' AS DI_LEI
	FROM T_STAT_BH WHERE DL IN ('0111','0112','0113') AND Q_DL NOT IN ('0111','0112','0113') 
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0111' AS DI_LEI
	FROM T_STAT_BH WHERE DL =  '0111' AND Q_DL <> '0111'  
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0113' AS DI_LEI
	FROM T_STAT_BH WHERE DL =  '0113' AND Q_DL <> '0113'  
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0112' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0112' AND Q_DL <>  '0112'  
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0120' AS DI_LEI
	FROM T_STAT_BH WHERE DL ='0120' AND Q_DL <>  '0120' 
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0130' AS DI_LEI
	FROM T_STAT_BH WHERE DL IN ('0131','0132') AND Q_DL NOT IN ('0131','0132')
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0131' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0131' AND Q_DL <>  '0131' 
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0132' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0132' AND Q_DL <>  '0132'  
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0140' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0140' AND Q_DL <>  '0140'
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0150' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0150' AND  Q_DL <>  '0150' 
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0160' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0160' AND  Q_DL <>  '0160' 
	UNION ALL
	SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0170' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0170' AND  Q_DL <>  '0170' 
	UNION ALL SELECT SHENG,  SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN,  LD_QS, MIAN_JI, '0180' AS DI_LEI
	FROM T_STAT_BH WHERE DL = '0180' AND  Q_DL <>  '0180';
GO
IF OBJECT_ID('T_STAT_01_NXHJ')IS NOT NULL DROP VIEW T_STAT_01_NXHJ
GO
CREATE VIEW T_STAT_01_NXHJ AS 
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0100' AS DI_LEI
	FROM T_STAT_XZ WHERE DL <> '0200'
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN , LD_QS, MIAN_JI, '0110' AS DI_LEI
	FROM T_STAT_XZ where DL IN ('0111','0112','0113')
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0111' AS DI_LEI
	FROM T_STAT_XZ where DL='0111'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0113' AS DI_LEI
	FROM T_STAT_XZ where DL='0113'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0112' AS DI_LEI
	FROM T_STAT_XZ where DL='0112'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0120' AS DI_LEI
	FROM T_STAT_XZ where DL='0120'
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, LD_QS, MIAN_JI , '0130' AS DI_LEI
	FROM T_STAT_XZ where DL IN ('0131','0132')
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0131' AS DI_LEI
	FROM T_STAT_XZ where DL='0131'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0132' AS DI_LEI
	FROM T_STAT_XZ where DL='0132'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0140' AS DI_LEI
	FROM T_STAT_XZ where DL in ('0140','0141','0142')
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0150' AS DI_LEI
	FROM T_STAT_XZ where DL='0150'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0160' AS DI_LEI
	FROM T_STAT_XZ where DL in ('0160','0161','0162','1631','1632','1633','1634')
	UNION  all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0170' AS DI_LEI
	FROM T_STAT_XZ where DL in ('0170','0171','0172','0173')
	UNION ALL SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0180' AS DI_LEI
	FROM T_STAT_XZ where DL='0180';
GO
IF OBJECT_ID('T_STAT_01_NX')IS NOT NULL DROP VIEW T_STAT_01_NX
GO
CREATE VIEW T_STAT_01_NX AS 
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , '00' AS LD_QS, MIAN_JI, DI_LEI
	FROM T_STAT_01_NXHJ
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0100' AS DI_LEI
	FROM T_STAT_XZ WHERE DL <> '0200'
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN , LD_QS, MIAN_JI, '0110' AS DI_LEI
	FROM T_STAT_XZ where DL IN ('0111','0112','0113')
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0111' AS DI_LEI
	FROM T_STAT_XZ where DL='0111'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0113' AS DI_LEI
	FROM T_STAT_XZ where DL='0113'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0112' AS DI_LEI
	FROM T_STAT_XZ where DL='0112'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0120' AS DI_LEI
	FROM T_STAT_XZ where DL='0120'
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU, LIN_CHANG, LIN_BAN, LD_QS, MIAN_JI , '0130' AS DI_LEI
	FROM T_STAT_XZ where DL IN ('0131','0132')
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0131' AS DI_LEI
	FROM T_STAT_XZ where DL='0131'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0132' AS DI_LEI
	FROM T_STAT_XZ where DL='0132'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0140' AS DI_LEI
	FROM T_STAT_XZ where DL in ('0140','0141','0142')
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0150' AS DI_LEI
	FROM T_STAT_XZ where DL='0150'
	UNION all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0160' AS DI_LEI
	FROM T_STAT_XZ where DL in ('0160','0161','0162','1631','1632','1633','1634')
	UNION  all
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0170' AS DI_LEI
	FROM T_STAT_XZ where DL in ('0170','0171','0172','0173')
	UNION ALL SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, '0180' AS DI_LEI
	FROM T_STAT_XZ where DL='0180';
GO
IF OBJECT_ID('T_STAT_01_JZ')IS NOT NULL DROP VIEW T_STAT_01_JZ
GO
CREATE VIEW T_STAT_01_JZ AS 
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , DI_LEI, LD_QS, MIAN_JI
	FROM T_STAT_01_XZ
	UNION ALL
	SELECT SHENG, SHI, XIAN, XIANG, CUN, LIN_YE_JU ,LIN_CHANG ,LIN_BAN , DI_LEI, LD_QS, -abs(MIAN_JI)
	FROM T_STAT_01_JS
GO
IF OBJECT_ID('T_STAT_01_HB')IS NOT NULL DROP VIEW T_STAT_01_HB
GO
CREATE VIEW T_STAT_01_HB AS	
	SELECT SHENG, SHI, XIAN, (XIAN + XIANG) AS XIANG, CUN, LIN_YE_JU ,(LIN_YE_JU+LIN_CHANG) AS LIN_CHANG ,LIN_BAN , LD_QS,  MIAN_JI, DI_LEI, '1' as STAT
	FROM T_STAT_01_NX	
	UNION ALL
	SELECT SHENG, SHI, XIAN, (XIAN + XIANG) AS XIANG, CUN, LIN_YE_JU ,(LIN_YE_JU+LIN_CHANG) AS LIN_CHANG ,LIN_BAN , LD_QS, MIAN_JI, DI_LEI, '2' as STAT
	FROM T_STAT_01_XZ	
	UNION ALL
	SELECT SHENG,SHI, XIAN, (XIAN + XIANG) AS XIANG, CUN, LIN_YE_JU ,(LIN_YE_JU+LIN_CHANG) AS LIN_CHANG ,LIN_BAN , LD_QS,  MIAN_JI, DI_LEI, '3' as STAT
	FROM T_STAT_01_JS	
	UNION ALL SELECT SHENG, SHI, XIAN, (XIAN + XIANG) AS XIANG, CUN, LIN_YE_JU ,(LIN_YE_JU+LIN_CHANG) AS LIN_CHANG ,LIN_BAN , LD_QS,  MIAN_JI, DI_LEI, '4' as STAT
	FROM T_STAT_01_JZ;
GO
IF OBJECT_ID('T_STAT_01_TMP')IS NOT NULL DROP VIEW T_STAT_01_TMP
GO
CREATE VIEW T_STAT_01_TMP AS 
	SELECT
		CASE GROUPING(XIAN) WHEN 1 THEN '合计' ELSE XIAN END AS XIAN,
		CASE GROUPING(XIANG) WHEN 1 THEN '合计' ELSE XIANG END AS XIANG,
		CASE GROUPING(LD_QS) WHEN 1 THEN '合计' ELSE LD_QS END AS LD_QS,
		CASE GROUPING(STAT) WHEN 1 THEN '合计' ELSE STAT END AS STAT,
		CASE GROUPING(DI_LEI) WHEN 1 THEN '合计' ELSE DI_LEI END AS DI_LEI,	
		SUM(MIAN_JI) AS MIAN_JI
	  FROM T_STAT_01_HB 
	  GROUP BY XIAN,XIANG,LD_QS,STAT,DI_LEI WITH  CUBE; 
GO
IF OBJECT_ID('T_STAT_01_DT')IS NOT NULL DROP VIEW T_STAT_01_DT
GO
CREATE VIEW T_STAT_01_DT AS 
	SELECT * FROM T_STAT_01_TMP 
		WHERE XIAN<>'合计' 
		AND STAT<>'合计' AND LD_QS<>'合计' AND DI_LEI<>'合计' 
GO
IF OBJECT_ID('T_STAT_01')IS NOT NULL DROP VIEW T_STAT_01
GO
CREATE VIEW T_STAT_01 AS
  select 
    case XIANG when '合计' then XIAN  ELSE XIANG end AS FLD1,
    LD_QS AS FLD2,
	STAT AS  FLD3,
	max(case di_lei when '0100' then mian_ji  end )as FLD4,
	max(case di_lei when '0110' then mian_ji  end )as FLD5,
	max(case di_lei when '0111' then mian_ji  end )as FLD6,
	max(case di_lei when '0113' then mian_ji  end )as FLD7,
	max(case di_lei when '0112' then mian_ji  end )as FLD8,
	max(case di_lei when '0120' then mian_ji  end )as FLD9,
	max(case di_lei when '0130' then mian_ji  end )as FLD10,
	max(case di_lei when '0131' then mian_ji  end )as FLD11,
	max(case di_lei when '0132' then mian_ji  end) as FLD12,
	max(case di_lei when '0140' then mian_ji  end )as FLD13,
	max(case di_lei when '0150' then mian_ji  end )as FLD14,
	max(case di_lei when '0160' then mian_ji  end) as FLD15,
	max(case di_lei when '0170' then mian_ji  end )as FLD16,
	max(case di_lei when '0180' then mian_ji  end )as FLD17 
  FROM T_STAT_01_DT
  group by XIAN,XIANG,LD_QS,STAT