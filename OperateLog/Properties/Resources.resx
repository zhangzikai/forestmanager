<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" use="required" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <data name="CreateReport" xml:space="preserve">
    <value>CREATE TABLE [dbo].[T_STAT_REPORT](
	[Theme] [nvarchar](10) NULL,
	[ReportID] [int] NOT NULL,
	[ReportName] [nvarchar](50) NOT NULL,
	[DataTable] [nvarchar](50) NULL,
	[TableSql] [nvarchar](max) NULL,
	[StoredProcedure] [nvarchar](20) NULL,
	[StoredProcedureSql] [nvarchar](max) NULL,
	[UseStoredProcedure] [nvarchar](1) NULL,
	[StaticSQL] [nvarchar](max) NULL,
	[StartIndex] [int] NULL,
	[GroupIndex] [nvarchar](1000) NULL,
	[DtColIndex] [int] NULL,
	[reportyear] [int] NULL,
	[IsShow] [int] NULL,
	[MergeColIndex] [nvarchar](30) NULL
) ON [PRIMARY]
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'CF', 6, N'皆伐伐区调查设计按树种统计汇总表', N'T_STAT_CF_FQJFSZHZ', N'CREATE TABLE [T_STAT_CF_FQJFSZHZ]([XIAN] [nvarchar](7) NULL,[XIANNAME] [nvarchar](50) NULL,[XIANG] [nvarchar](10) NULL,[XIANGNAME] [nvarchar](50) NULL,[CUN] [nvarchar](13) NULL,[CUNNAME] [nvarchar](50) NULL,[SZ] [nvarchar](50) NULL,[SZNAME] [nvarchar](50) NULL,[ZYMJ] [numeric](38, 2) NULL,[CFXJ] [numeric](38, 3) NULL,[CFZS] [numeric](38, 0) NULL,[CCL] [numeric](38, 4) NULL) ON [PRIMARY]', N'SP_STAT_CF_FQJFSZHZ', N'Create PROCEDURE [SP_STAT_CF_FQJFSZHZ](@tj nvarchar(max)) AS declare @year varchar(4) declare yearcursor cursor for select top 1 reportyear from t_stat_report open yearcursor fetch next from yearcursor into @year close yearcursor DEALLOCATE yearcursor delete from T_STAT_CF_FQJFSZHZ exec(''insert into T_STAT_CF_FQJFSZHZ(XIANG,CUN,SZ,ZYMJ,CFXJ,CFZS,CCL) select case grouping(xiang) when 1 then null else xiang end as xiang,case grouping(cun) when 1 then null else cun end as cun,case grouping(sz) when 1 then null else sz end as sz,sum(zymj),SUM(CFMJ),SUM(CFZS),SUM(ccl) from (select xiang,cun,case ltrim(YOU_SHI_SZ) when '''''''' then ''''000'''' when null then ''''000'''' else YOU_SHI_SZ end as sz,mian_ji as zymj,cfmj,CFZS,nullif(ggcccl,0)+nullif(fggcccl,0) as ccl from ZT_CF_''+@year+'' a where ''+@tj+'' and cffs=''''11'''')b group by xiang,cun,sz with cube'') delete from T_STAT_CF_FQJFSZHZ where XIANG is null and CUN is not null exec(''update a set a.XIAN=b.XIAN from T_STAT_CF_FQJFSZHZ a inner join ZT_CF_''+@year+'' b on ISNULL(a.XIANG,''''0'''')=ISNULL(b.XIANG,''''0'''')'') update T_STAT_CF_FQJFSZHZ set XIANNAME=XIAN,XIANGNAME=XIANG,CUNNAME=CUN,SZNAME=SZ update T_STAT_CF_FQJFSZHZ set XIANNAME=(select cname from t_sys_meta_code b where XIAN=b.CCODE and b.cindex=''103''),XIANGNAME=(select cname from T_SYS_META_CODE b where XIANG=b.CCODE and b.cindex=''104''),CUNNAME =(select cname from t_sys_meta_code b where CUN=b.ccode and b.CINDEX=''105''),SZNAME=(select cname from t_sys_meta_code b where SZ=b.ccode and b.CINDEX=''219'') update T_STAT_CF_FQJFSZHZ set SZNAME=''合计'' where SZ is null update T_STAT_CF_FQJFSZHZ set CUNNAME=XIANGNAME where CUN is null update T_STAT_CF_FQJFSZHZ set XIANGNAME=''总计'' where XIANG is null update T_STAT_CF_FQJFSZHZ set CUNNAME=XIANGNAME where CUN is null', N'1', N'select XIANNAME,XIANGNAME,CUNNAME,SZNAME,ZYMJ,CFXJ,CFZS,CCL from T_STAT_CF_FQJFSZHZ order by XIANG,CUN,SZ', 5, N'2,3,XIANNAME;', 1, 2013, 0, N'')
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'ZH', 0, N'病虫害按区域统计年报表', N'T_STAT_ZH_BCHQY', N'CREATE TABLE [T_STAT_ZH_BCHQY]([XZQY] [bigint] NULL,[XZQYNAME] [nvarchar](50) NULL,[PX] [smallint] NULL,[XMC] [nvarchar](3) NULL,[XM] [nvarchar](50) NULL,[FSMJHJ] [numeric](38, 2) NULL,[QJ] [numeric](38, 2) NULL,[ZJ] [numeric](38, 2) NULL,[ZZJ] [numeric](38, 2) NULL,[CZHJ] [numeric](38, 2) NULL,[CZQJ] [numeric](38, 2) NULL,[CZZJ] [numeric](38, 2) NULL,[CZZZJ] [numeric](38, 2) NULL,[SLMJ] [numeric](38, 2) NULL,[CZL] [varchar](50) NULL,[SWZS] [bigint] NULL) ON [PRIMARY]', N'SP_STAT_ZH_BCHQY', N'CREATE PROCEDURE [SP_STAT_ZH_BCHQY] AS declare @year varchar(4),@TableName varchar(50) declare yearcursor cursor for select top 1 reportyear from t_stat_report open yearcursor fetch next from yearcursor into @year close yearcursor DEALLOCATE yearcursor set @TableName=''ZT_ZH_''+@year delete from T_STAT_ZH_BCHQY exec(''insert into  T_STAT_ZH_BCHQY(XZQY,XZQYNAME,PX,XMC,XM,QJ,ZJ,ZZJ,CZQJ,CZZJ,czzzj,SLMJ,SWZS) select 1 as xiang,null,0 as px,''''0'''' as zhlx,''''总计'''',(select SUM(mian_ji) from ''+@TableName+'' b where disaster_c=1),(select SUM(mian_ji) from ''+@TableName+'' b where disaster_c=2),(select SUM(mian_ji) from ''+@TableName+'' b where disaster_c=3),(select SUM(ZHMJ) from ''+@TableName+'' b where disaster_c=1),(select SUM(ZHMJ) from ''+@TableName+'' b where disaster_c=2),(select SUM(ZHMJ) from ''+@TableName+'' b where disaster_c=3),sum(case when LEFT(DI_LEI,1) = ''''1'''' or DI_LEI=''''301'''' or LEFT(DI_LEI,2)=''''96'''' then CONVERT(decimal(18,1),MIAN_JI) else 0 end),sum(SSZS) from ''+@TableName+'' union select case grouping(XIANG) when 1 then 1 else XIANG end as xiang,(select cname from T_SYS_Meta_code b where a.XIANG=b.CCODE and CINDEX=''''104''''),0 as px,''''0'''' as zhlx,''''总计'''',(select SUM(mian_ji) from ''+@TableName+'' b where a.XIANG=b.XIANG and disaster_c=1 group by b.XIANG,b.DISASTER_C),(select SUM(mian_ji) from ''+@TableName+'' b where a.XIANG=b.XIANG and disaster_c=2 group by b.XIANG,b.DISASTER_C),(select SUM(mian_ji) from ''+@TableName+'' b where a.XIANG=b.XIANG and disaster_c=3 group by b.XIANG,b.DISASTER_C),(select SUM(ZHMJ) from ''+@TableName+'' b where a.XIANG=b.XIANG and disaster_c=1 group by b.XIANG,b.DISASTER_C),(select SUM(ZHMJ) from ''+@TableName+'' b where a.XIANG=b.XIANG and disaster_c=2 group by b.XIANG,b.DISASTER_C),(select SUM(ZHMJ) from ''+@TableName+'' b where a.XIANG=b.XIANG and disaster_c=3 group by b.XIANG,b.DISASTER_C),sum(case when LEFT(DI_LEI,1) = ''''1'''' or DI_LEI=''''301'''' or LEFT(DI_LEI,2)=''''96'''' then CONVERT(decimal(18,1),MIAN_JI) else 0 end),sum(SSZS) from ''+@TableName+'' a GROUP BY XIANG union select case grouping(XIANG) when 1 then 1 else XIANG end as xiang,(select cname from T_SYS_Meta_code b where a.XIANG=b.CCODE and CINDEX=''''104''''),1 as px,case grouping(YHSW) when ''''1'''' then ''''1'''' else YHSW end as zhlx,(select cname from T_SYS_Meta_code b where a.YHSW=b.CCODE and CINDEX=''''266''''),(select SUM(mian_ji) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=1 group by b.XIANG,b.YHSW,b.DISASTER_C),(select SUM(mian_ji) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=2 group by b.XIANG,b.YHSW,b.DISASTER_C),(select SUM(mian_ji) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=3 group by b.XIANG,b.YHSW,b.DISASTER_C),(select SUM(ZHMJ) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=1 group by b.XIANG,b.YHSW,b.DISASTER_C),(select SUM(ZHMJ) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=2 group by b.XIANG,b.YHSW,b.DISASTER_C),(select SUM(ZHMJ) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=3 group by b.XIANG,b.YHSW,b.DISASTER_C),sum(case when LEFT(DI_LEI,1) = ''''1'''' or DI_LEI=''''301'''' or LEFT(DI_LEI,2)=''''96'''' then CONVERT(decimal(18,1),MIAN_JI) else 0 end),sum(SSZS) from ''+@TableName+'' a where DISPE=''''11'''' and YHSW is not null and LTRIM(YHSW)!='''''''' GROUP BY XIANG,YHSW WITH cube  union SELECT case grouping(XIANG) when 1 then 1 else XIANG end as xiang,(select cname from T_SYS_Meta_code b where a.XIANG=b.CCODE and CINDEX=''''104''''),2 as px,case grouping(YHSW) when ''''1'''' then ''''1'''' else YHSW end as zhlx,(select cname from T_SYS_Meta_code b where a.YHSW=b.CCODE and CINDEX=''''266''''),(select SUM(mian_ji) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=1 group by b.XIANG,b.YHSW,b.DISASTER_C),(select SUM(mian_ji) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=2 group by b.XIANG,b.YHSW,b.DISASTER_C),(select SUM(mian_ji) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=3 group by b.XIANG,b.YHSW,b.DISASTER_C),(select SUM(ZHMJ) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=1 group by b.XIANG,b.YHSW,b.DISASTER_C),(select SUM(ZHMJ) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=2 group by b.XIANG,b.YHSW,b.DISASTER_C),(select SUM(ZHMJ) from ''+@TableName+'' b where a.XIANG=b.XIANG and a.YHSW=b.YHSW and disaster_c=3 group by b.XIANG,b.YHSW,b.DISASTER_C),sum(case when LEFT(DI_LEI,1) = ''''1'''' or DI_LEI=''''301'''' or LEFT(DI_LEI,2)=''''96'''' then CONVERT(decimal(18,1),MIAN_JI) else 0 end),sum(SSZS) from ''+@TableName+'' a where DISPE=''''12'''' and YHSW is not null and LTRIM(YHSW)!='''''''' GROUP BY XIANG,YHSW WITH cube'') update T_STAT_ZH_BCHQY set FSMJHJ=ISNULL(QJ,0)+ISNULL(zj,0)+ISNULL(zzj,0) update T_STAT_ZH_BCHQY set FSMJHJ=null where FSMJHJ=0 update T_STAT_ZH_BCHQY set CZHJ=ISNULL(CZQJ,0)+ISNULL(CZZJ,0)+ISNULL(CZZZJ,0) update T_STAT_ZH_BCHQY set CZHJ=null where CZHJ=0 update T_STAT_ZH_BCHQY set XZQYNAME=''全县'' where XZQY=1 update T_STAT_ZH_BCHQY set XM=''一、病害合计'' where px=1 and XMC=''1'' update T_STAT_ZH_BCHQY set XM=''二、虫害合计'' where px=2 and XMC=''1'' update a set a.FSMJHJ=b.FSMJHJ,a.QJ=b.qj,a.ZJ=b.zj,a.ZZJ=b.ZZJ,a.CZHJ=b.czhj,a.CZQJ=b.czqj,a.CZZJ=b.czzj,a.CZZZJ=b.czzzj  from T_STAT_ZH_BCHQY a left join (select XZQY,px,sum(FSMJHJ) as FSMJHJ,SUM(qj) as qj,SUM(zj) as zj,SUM(ZZJ) as ZZJ,SUM(CZHJ) as czhj,SUM(CZQJ) as czqj,SUM(CZZJ) as czzj,SUM(CZZZJ) as czzzj from T_STAT_ZH_BCHQY group by XZQY,PX)b on a.XZQY=b.XZQY and a.PX=b.PX where a.XMC=1 or a.XMC=0 or a.XMC=2 update a set a.FSMJHJ=b.FSMJHJ,a.QJ=b.qj,a.ZJ=b.zj,a.ZZJ=b.ZZJ,a.CZHJ=b.czhj,a.CZQJ=b.czqj,a.CZZJ=b.czzj,a.CZZZJ=b.czzzj from T_STAT_ZH_BCHQY a left join (select PX,XMC,sum(FSMJHJ) as FSMJHJ,SUM(qj) as qj,SUM(zj) as zj,SUM(ZZJ) as ZZJ,SUM(CZHJ) as czhj,SUM(CZQJ) as czqj,SUM(CZZJ) as czzj,SUM(CZZZJ) as czzzj from T_STAT_ZH_BCHQY group by PX,XMC)b on a.PX=b.PX and a.XMC=b.XMC where a.XZQY=1 and a.PX!=0 update T_STAT_ZH_BCHQY set CZL=convert(nvarchar(5),cast(round(CZHJ*100/case SLMJ when 0 then null else FSMJHJ end,2) as numeric(5,2)))+''%'' ', N'1', N'select xzqyname,xm,fsmjhj,qj,zj,zzj,czhj,czqj,czzj,czzzj,czl,swzs from T_STAT_ZH_BCHQY order by xzqy,px,case when xmc is NULL then 2 when ltrim(xmc)='''' then 3 else xmc end', 6, NULL, 0, 2013, 1, N'1')
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'SF', 3, N'森林火灾分类型统计表', NULL, NULL, NULL, NULL, N'0', N'select case grouping(yuefen) when 1 then ''全年合计'' else yuefen+''月'' end,case grouping(hzdj) when 1 then ''合计'' else (select cname from t_sys_meta_code b where a.hzdj=b.ccode and cindex=''263'') end,count(1),sum(TOTAL_MJ),sum(ysl_mj+rgl_mj),SUM(YSL_MJ),SUM(RGL_MJ),SUM(SS_CL),SUM(SS_YL),sum(shang_q+shang_z+shang_s),sum(SHANG_Q),SUM(SHANG_Z),  SUM(SHANG_S),SUM(SS_MONEY),  SUM(PU_RG),SUM(PU_CL),sum(PU_QC),SUM(PU_FJ),SUM(PU_JF) from   (select str(MONTH(QHSJ),2) as yuefen,hzdj,TOTAL_MJ,YSL_MJ,RGL_MJ,SS_CL,SS_YL,SHANG_Q,SHANG_Z,SHANG_S,SS_MONEY,PU_RG,PU_CL,PU_QC,PU_FJ,PU_JF   from T_ZT_HZ_INFO)a  group by yuefen,HZDJ with cube order by yuefen,a.HZDJ', 4, NULL, 0, 2013, 1, N'1')
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'CF', 5, N'择伐、渐伐、抚育采伐伐区调查设计按树种统计汇总表', N'T_STAT_CF_FQZFSZHZ ', N'CREATE TABLE [T_STAT_CF_FQZFSZHZ]([XIAN] [nvarchar](7) NULL,[XIANNAME] [nvarchar](50) NULL,[XIANG] [nvarchar](10) NULL,[XIANGNAME] [nvarchar](50) NULL,[CUN] [nvarchar](13) NULL,[CUNNAME] [nvarchar](50) NULL,[SZ] [nvarchar](50) NULL,[SZNAME] [nvarchar](50) NULL,[ZYMJ] [numeric](38, 2) NULL,[CFXJ] [numeric](38, 3) NULL,[CFZS] [numeric](38, 0) NULL,[CCL] [numeric](38, 4) NULL) ON [PRIMARY]', N'SP_STAT_CF_FQZFSZHZ', N'Create PROCEDURE [SP_STAT_CF_FQZFSZHZ](@tj nvarchar(max)) AS declare @year varchar(4) declare yearcursor cursor for select top 1 reportyear from t_stat_report open yearcursor fetch next from yearcursor into @year close yearcursor DEALLOCATE yearcursor delete from T_STAT_CF_FQZFSZHZ exec(''insert into T_STAT_CF_FQZFSZHZ(XIANG,CUN,SZ,ZYMJ,CFXJ,CFZS,CCL) select case grouping(xiang) when 1 then null else xiang end as xiang,case grouping(cun) when 1 then null else cun end as cun,case grouping(sz) when 1 then null else sz end as sz,sum(zymj),SUM(CFMJ),SUM(CFZS),SUM(ccl) from (select xiang,cun,case ltrim(YOU_SHI_SZ) when '''''''' then ''''000'''' when null then ''''000'''' else YOU_SHI_SZ end as sz,mian_ji as zymj,cfmj,CFZS,nullif(ggcccl,0)+nullif(fggcccl,0) as ccl from ZT_CF_''+@year+'' a where ''+@tj+'' and (CFFS=''''12'''' OR CFFS=''''13'''' OR CFFS=''''21''''))b group by xiang,cun,sz with cube'') delete from T_STAT_CF_FQZFSZHZ where XIANG is null and CUN is not null exec(''update a set a.XIAN=b.XIAN from T_STAT_CF_FQZFSZHZ a inner join ZT_CF_''+@year+'' b on ISNULL(a.XIANG,''''0'''')=ISNULL(b.XIANG,''''0'''')'') update T_STAT_CF_FQZFSZHZ set XIANNAME=XIAN,XIANGNAME=XIANG,CUNNAME=CUN,SZNAME=SZ update T_STAT_CF_FQZFSZHZ set XIANNAME=(select cname from t_sys_meta_code b where XIAN=b.CCODE and b.cindex=''103''),XIANGNAME=(select cname from T_SYS_META_CODE b where XIANG=b.CCODE and b.cindex=''104''),CUNNAME =(select cname from t_sys_meta_code b where CUN=b.ccode and b.CINDEX=''105''),SZNAME=(select cname from t_sys_meta_code b where SZ=b.ccode and b.CINDEX=''219'') update T_STAT_CF_FQZFSZHZ set SZNAME=''合计'' where SZ is null update T_STAT_CF_FQZFSZHZ set CUNNAME=XIANGNAME where CUN is null update T_STAT_CF_FQZFSZHZ set XIANGNAME=''总计'' where XIANG is null update T_STAT_CF_FQZFSZHZ set CUNNAME=XIANGNAME where CUN is null', N'1', N'select XIANNAME,XIANGNAME,CUNNAME,SZNAME,ZYMJ,CFXJ,CFZS,CCL from T_STAT_CF_FQZFSZHZ order by XIANG,CUN,SZ', 5, N'2,3,XIANNAME;', 1, 2013, 0, N'')
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'CF', 3, N'伐区调查及林木检尺登记表', NULL, NULL, NULL, NULL, N'0', N'with tj as (select c.xianname,c.xiangname,(select cname from t_sys_meta_code b where a.cun=b.CCODE and b.cindex=''105'') as cunname,case substring(a.LIN_BAN,1,1) when ''0'' then substring(a.LIN_BAN,2,1) else substring(a.LIN_BAN,1,2) end as LIN_BAN,DCXB,ZYXB,c.LMSYZXM,c.MIAN_JI,c.lz,c.yssz,c.qi_yuan,c.PINGJUN_NL,c.YU_BI_DU,c.cflx,c.CFCS,c.PJGF,c.SSZZS,c.SSXJ,c.gxdj,c.gxfs,c.gxsz,c.GXSJ,BZDH,BZDMJ,JCSZ,(select cname from t_sys_meta_code b where jcsz=b.CCODE and b.cindex=''219'') as jcszname,JJ,JCLX,(select cname from t_sys_meta_code b where JCLX=b.CCODE and b.cindex=''255'') as jclxname,YCZS,BYCZS,XCZS,isnull(YCZS,0)+isnull(BYCZS,0)+isnull(XCZS,0) as hj,D1,H1,D2,H2,D3,H3,PJZJ,PJG FROM T_ZT_CF_MMJC a inner join (select (select cname from t_sys_meta_code b where XIAN=b.CCODE and b.cindex=''103'') as xianname,(select cname from t_sys_meta_code b where XIANG=b.CCODE and b.cindex=''104'') as xiangname,cun,LIN_BAN,XIAO_BAN,XI_BAN,LMSYZXM,MIAN_JI,(select cname from t_sys_meta_code b where LIN_ZHONG=b.CCODE and b.cindex=''212'') as lz,(select cname from t_sys_meta_code b where YOU_SHI_SZ=b.CCODE and b.cindex=''219'') as yssz,(select cname from t_sys_meta_code b where QI_YUAN=b.CCODE and b.cindex=''213'') as qi_yuan,PINGJUN_NL,YU_BI_DU,(select cname from t_sys_meta_code b where CFFS=b.CCODE and b.cindex=''273'') as cflx,CFCS,PJGF,SSZZS,SSXJ,(select cname from t_sys_meta_code b where GXDJ=b.CCODE and b.cindex=''251'') as gxdj,(select cname from t_sys_meta_code b where GXFS=b.CCODE and b.cindex=''252'') as gxfs,(select cname from t_sys_meta_code b where GXSZ=b.CCODE and b.cindex=''219'') as gxsz,GXSJ from ZT_CF_{0} where {1})c on a.cun=c.cun and a.LIN_BAN=c.LIN_BAN and a.DCXB=c.XIAO_BAN and a.ZYXB=c.XI_BAN)select xianname,xiangname,cunname,LIN_BAN,DCXB,ZYXB,LMSYZXM,cast(MIAN_JI as nvarchar) as mj,lz,yssz,qi_yuan,cast(PINGJUN_NL as nvarchar) as ll,cast(YU_BI_DU as nvarchar) as ybd,cflx,cast(CFCS as nvarchar) as cs,cast(PJGF as nvarchar) as gf,cast(SSZZS as nvarchar) as zs,cast(SSXJ as nvarchar) as xj,gxdj,gxfs,gxsz,GXSJ,BZDH,cast(BZDMJ as nvarchar) as bmj,jcszname,JJ,jclxname,YCZS,BYCZS,XCZS,hj,case D1 when 0 then null else cast(D1 as numeric(38,1)) end as d1,case H1 when 0 then null else cast(H1 as numeric(38,1)) end as h1,case D2 when 0 then null else cast(D2 as numeric(38,1)) end as d2,case H2 when 0 then null else cast(H2 as numeric(38,1)) end as h2,case D3 when 0 then null else cast(D3 as numeric(38,1)) end as d3,case H3 when 0 then null else cast(H3 as numeric(38,1)) end as h3,cast(PJZJ as numeric(38,1)) as PJZJ,cast(PJG as numeric(38,1)) as PJG from tj union select xianname,xiangname,cunname,LIN_BAN,DCXB,ZYXB,'''','''','''','''','''','''','''','''','''','''','''','''','''','''','''','''',bzdh,'''',''稓稓稓稓'',10000,jclxname+''木'',SUM(YCZS),SUM(BYCZS),SUM(XCZS),SUM(hj),null,null,null,null,null,null,round(SUM(PJZJ*hj)/case SUM(hj) when 0 then null else SUM(hj) end,1),round(SUM(PJG*hj)/case SUM(hj) when 0 then null else SUM(hj) end,1) from tj group by xianname,xiangname,cunname,LIN_BAN,DCXB,ZYXB,BZDH,jclxname order by 1,2,3,4,5,6,23,25,26,27', 12, N'3,1,xianname;3,3,xiangname;3,5,cunname;3,8,LIN_BAN;3,10,DCXB;3,12,ZYXB;3,15,mj;4,4,lz;4,6,yssz;4,8,qi_yuan;4,10,ll;4,12,ybd;4,14,cflx;5,2,cs;5,4,gf;5,6,zs;5,9,xj;5,13,gxdj;6,2,gxfs;6,4,gxsz;6,7,gxsj;7,4,bzdh;7,7,bmj;', 24, 2013, 0, NULL)
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'AJ', 0, N'林业行政案件按月份统计表', N'T_STAT_AJ_AJYF', N'CREATE TABLE [T_STAT_AJ_AJYF]([YF] [varchar](6) NULL,[YFNAME] [varchar](6) NULL,[AJMC] [smallint] NULL,[AJMCNAME] [varchar](50) NULL,[FSZS] [int] NULL,[ZF] [int] NULL,[QY] [int] NULL,[GM] [int] NULL,[QTZZ] [int] NULL,[LD] [numeric](38, 2) NULL,[LM] [numeric](38, 3) NULL,[ZZ] [numeric](38, 4) NULL,[YSMM] [numeric](38, 4) NULL) ON [PRIMARY]', N'SP_STAT_AJ_AJYF', N'CREATE PROCEDURE SP_STAT_AJ_AJYF AS declare @year varchar(4),@TableName varchar(50) declare yearcursor cursor for select top 1 reportyear from t_stat_report open yearcursor fetch next from yearcursor into @year close yearcursor DEALLOCATE yearcursor set @TableName=''ZT_LYAJ_''+@year delete from T_STAT_AJ_AJYF EXEC(''insert into T_STAT_AJ_AJYF(YF,AJMC,LD,LM,ZZ,YSMM) select * from (select case grouping(yf) when 1 then -1 else yf end as yf,case grouping(ajlx) when 1 then -1 else AJLX end as ajlx,SUM(SSLDMJ) as ld,SUM(SSLMXJ) as lm,SUM(SSMZZS) as sm,SUM(SSYSMMZS) as ys from (select datepart(month,FSRQ) as yf,AJLX,SSLDMJ,SSLMXJ,SSMZZS,SSYSMMZS from ''+@TableName+'' a)c group by yf,AJLX with cube)a order by case when yf is null then 0 else yf end,case when AJLX is null then 0 else ajlx end'') exec(''update a set ZF=b.cs from T_STAT_AJ_AJYF a left join (select yf,ajlx,COUNT(1) as cs from (select datepart(month,FSRQ) as yf,ajlx from ''+@TableName+'' where xwzt=1)c group by yf,ajlx)b on a.yf=b.yf and a.AJMC=b.ajlx'') exec(''update a set QY=b.cs from T_STAT_AJ_AJYF a left join (select yf,ajlx,COUNT(1) as cs from (select datepart(month,FSRQ) as yf,ajlx from ''+@TableName+'' where xwzt=2)c group by yf,ajlx)b on a.yf=b.yf and a.AJMC=b.ajlx'') exec(''update a set GM=b.cs from T_STAT_AJ_AJYF a left join (select yf,ajlx,COUNT(1) as cs from (select datepart(month,FSRQ) as yf,ajlx from ''+@TableName+'' where xwzt=3)c group by yf,ajlx)b on a.yf=b.yf and a.AJMC=b.ajlx'') exec(''update a set QTZZ=b.cs from T_STAT_AJ_AJYF a left join (select yf,ajlx,COUNT(1) as cs from (select datepart(month,FSRQ) as yf,ajlx from ''+@TableName+'' where xwzt=4)c group by yf,ajlx)b on a.yf=b.yf and a.AJMC=b.ajlx'') update T_STAT_AJ_AJYF set AJMCNAME=(select CNAME from T_SYS_META_CODE where CCODE=AJMC and CINDEX=''256'') update T_STAT_AJ_AJYF set AJMCNAME=''合计'' where AJMC=-1 update T_STAT_AJ_AJYF set YFNAME=case YF when -1 then ''全年'' when ''1'' then ''一月'' when ''2'' then ''二月'' when ''3'' then ''三月'' when ''4'' then ''四月'' when ''5'' then ''五月'' when ''6'' then ''六月'' when ''7'' then ''七月'' when ''8'' then ''八月'' when ''9'' then ''九月'' when ''10'' then ''十月'' when ''11'' then ''十一月'' when 12 then ''十二月'' else YF end update a set zf=b.zf,qy=b.qy,gm=b.gm,qtzz=b.qtzz from T_STAT_AJ_AJYF a inner join (select YF,SUM(zf) as zf,SUM(qy) as qy,SUM(gm) as gm,SUM(qtzz) as qtzz from T_STAT_AJ_AJYF group by YF)b on a.AJMC=-1 and a.YF=b.YF update a set zf=b.zf,qy=b.qy,gm=b.gm,qtzz=b.qtzz from T_STAT_AJ_AJYF a inner join (select AJMC,SUM(zf) as zf,SUM(qy) as qy,SUM(gm) as gm,SUM(qtzz) as qtzz from T_STAT_AJ_AJYF group by AJMC)b on a.YF=-1 and a.AJMC=b.AJMC update T_STAT_AJ_AJYF set FSZS=ISNULL(zf,0)+ISNULL(qy,0)+ISNULL(gm,0)+ISNULL(qtzz,0)', N'1', N'select YFNAME,AJMCNAME,FSZS,ZF,QY,GM,QTZZ,LD,LM,ZZ,YSMM from T_STAT_AJ_AJYF', 7, NULL, 0, 2013, 1, N'1')
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'CF', 0, N'皆伐伐区调查设计汇总表', N'T_STAT_CF_FQJFHZ', N'CREATE TABLE [T_STAT_CF_FQJFHZ]([SHENG] [nvarchar](3) NULL,[SHENGNAME] [nvarchar](50) NULL,[SHI] [nvarchar](5) NULL,[SHINAME] [nvarchar](50) NULL,[XIAN] [nvarchar](7) NULL,[XIANNAME] [nvarchar](50) NULL,[XIANG] [nvarchar](10) NULL,[XIANGNAME] [nvarchar](50) NULL,[CUN] [nvarchar](13) NULL,[CUNNAME] [nvarchar](50) NULL,[LB] [nvarchar](5) NULL,[LBNAME] [nvarchar](50) NULL,[XB] [nvarchar](5) NULL,[XBNAME] [nvarchar](50) NULL,[ZYXB] [nvarchar](11) NULL,[ZYXBNAME] [nvarchar](11) NULL,[XM] [nvarchar](50) NULL,[LZ] [nvarchar](3) NULL,[LZNAME] [nvarchar](50) NULL,[SZ] [nvarchar](6) NULL,[SZNAME] [nvarchar](50) NULL,[QY] [nvarchar](2) NULL,[QYNAME] [nvarchar](50) NULL,[LL] [smallint] NULL,[YBD] [numeric](38, 1) NULL,[PJZJ] [numeric](38, 1) NULL,[PJSG] [numeric](38, 1) NULL,[TRGXDJ] [nvarchar](50) NULL,[TRGXDJNAME] [nvarchar](50) NULL,[GQXJ] [numeric](38, 1) NULL,[CFMJ] [numeric](38, 2) NULL,[CFXJ] [numeric](38, 1) NULL,[CFZS] [numeric](38, 0) NULL,[CCL] [numeric](38, 8) NULL,[JDGXFS] [nvarchar](50) NULL,[JDGXFSNAME] [nvarchar](50) NULL,[JDGXSZ] [nvarchar](50) NULL,[JDGXSZNAME] [nvarchar](50) NULL,[JDGXSJ] [nvarchar](8) NULL) ON [PRIMARY]', N'SP_STAT_CF_FQJFHZ', N'Create PROCEDURE [SP_STAT_CF_FQJFHZ](@tj nvarchar(max)) AS declare @year varchar(4) Declare yearcursor cursor for select top 1 reportyear from t_stat_report open yearcursor fetch next from yearcursor into @year close yearcursor DEALLOCATE yearcursor delete from T_STAT_CF_FQJFHZ exec(''insert into T_STAT_CF_FQJFHZ(XIANG,CUN,LB,XB,ZYXB,XM,SZ,PJZJ,PJSG,GQXJ,CFMJ,CFXJ,CFZS,CCL) select case GROUPING(XIANG) when 1 then ''''9000000000'''' else XIANG end as XIANG,case GROUPING(cun) when 1 then ''''9000000000000'''' else cun end as cun,case GROUPING(LIN_BAN) when 1 then ''''90000'''' else LIN_BAN end as LIN_BAN,case GROUPING(XIAO_BAN) when 1 then ''''90000'''' else XIAO_BAN end as XIAO_BAN,case grouping(XI_BAN) when 1 then ''''90000000000'''' else XI_BAN end as XI_BAN,CASE GROUPING(XM) WHEN 1 THEN ''''-1'''' ELSE XM END AS XM,CASE GROUPING(SZ) WHEN 1 THEN ''''9000'''' ELSE SZ END AS SZ,SUM(PINGJUN_XJ),SUM(PINGJUN_SG),SUM(HUO_LMGQXJ),SUM(CFMJ),SUM(cfxj),SUM(CFZS),SUM(CFCCL) FROM (SELECT XIANG,CUN,CASE LTRIM(LIN_BAN) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE LIN_BAN END AS LIN_BAN,CASE LTRIM(XIAO_BAN) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE XIAO_BAN END AS XIAO_BAN,CASE LTRIM(XI_BAN) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE XI_BAN END AS XI_BAN,case LTRIM(LMSYZXM) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE LMSYZXM END AS XM,CASE LTRIM(YOU_SHI_SZ) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE YOU_SHI_SZ END AS SZ,PINGJUN_XJ,PINGJUN_SG,HUO_LMGQXJ,CFMJ,CFXJ,CFZS,NULLIF(GGCCCL,0)+NULLIF(FGGCCCL,0) AS CFCCL from ZT_CF_''+@year+'' WHERE ''+@tj+'' and CFFS=''''11'''')A group by XIANG,CUN,LIN_BAN,XIAO_BAN,XI_BAN,XM,SZ with rollup ORDER BY XIANG,CUN,LIN_BAN,XIAO_BAN,XI_BAN,XM,SZ'') DELETE FROM T_STAT_CF_FQJFHZ WHERE SZ=''9000'' AND (XM!=''-1'' or XM IS NULL) DELETE FROM T_STAT_CF_FQJFHZ WHERE XM=''-1'' AND ZYXB&lt;''90000000000'' DELETE FROM T_STAT_CF_FQJFHZ WHERE ZYXB=''90000000000'' AND XB&lt;''90000'' update T_STAT_CF_FQJFHZ set PJZJ=null,PJSG=null,GQXJ=null where ZYXB=''90000000000'' exec(''update a set a.XIAN=b.XIAN from T_STAT_CF_FQJFHZ a inner join ZT_CF_''+@year+'' b on ISNULL(a.XIANG,''''0'''')=ISNULL(b.XIANG,''''0'''')'') exec(''update a set QY=b.QI_YUAN,LZ=b.LIN_ZHONG,LL=b.PINGJUN_NL,YBD=b.YU_BI_DU,TRGXDJ=b.GXDJ,JDGXFS=b.GXFS,JDGXSZ=b.GXSZ,JDGXSJ=b.GXSJ from T_STAT_CF_FQJFHZ a inner join ZT_CF_''+@year+'' b on ISNULL(a.XIANG,''''0'''')=ISNULL(b.XIANG,''''0'''') where ISNULL(a.CUN,''''0'''')=ISNULL(b.CUN,''''0'''') and ISNULL(a.LB,''''0'''')=ISNULL(b.LIN_BAN,''''0'''') and ISNULL(a.XB,''''0'''')=ISNULL(b.XIAO_BAN,''''0'''') and ISNULL(a.ZYXB,''''0'''')=ISNULL(b.XI_BAN,''''0'''') and ISNULL(a.XM,''''0'''')=ISNULL(b.LMSYZXM,''''0'''') and ISNULL(a.SZ,''''0'''')=ISNULL(b.YOU_SHI_SZ,''''0'''')'') update T_STAT_CF_FQJFHZ set XIANNAME=XIAN,XIANGNAME=XIANG,CUNNAME=CUN,LBNAME=LB,XBNAME=XB,ZYXBNAME=ZYXB,QYNAME=QY,LZNAME=LZ,SZNAME=SZ,TRGXDJNAME=TRGXDJ,JDGXFSNAME=JDGXFS,JDGXSZNAME=JDGXSZ update T_STAT_CF_FQJFHZ set XIANNAME=(select cname from t_sys_meta_code b where XIAN=b.CCODE and b.cindex=''103''),XIANGNAME=(select cname from t_sys_meta_code b where XIANG=b.CCODE and b.cindex=''104''),CUNNAME=(select cname from t_sys_meta_code b where cun=b.CCODE and b.cindex=''105''),QYNAME=(select cname from t_sys_meta_code b where qy=b.CCODE and b.CINDEX=''213''),LZNAME=(select cname from t_sys_meta_code b where lz=b.ccode and b.CINDEX=''212''),SZNAME=(select cname from t_sys_meta_code b where sz=b.ccode and b.CINDEX=''219''),TRGXDJNAME=(select cname from t_sys_meta_code b where TRGXDJ=b.ccode and b.cindex=''251''),JDGXFSNAME=(select cname from t_sys_meta_code b where JDGXFS=b.ccode and b.cindex=''252''),JDGXSZNAME=(select cname from t_sys_meta_code b where JDGXSZ=b.ccode and b.cindex=''219'') update T_STAT_CF_FQJFHZ set XBNAME=''林班合计'' where XB=''90000'' update T_STAT_CF_FQJFHZ set LBNAME=''合计'',XBNAME=null where LB=''90000'' update T_STAT_CF_FQJFHZ set CUNNAME=''合计'',LBNAME=null,XBNAME=null where CUN=''9000000000000'' update T_STAT_CF_FQJFHZ set XIANGNAME=''总合计'',CUNNAME=null,LBNAME=null,XBNAME=null where XIANG=''9000000000'' update T_STAT_CF_FQJFHZ set ZYXBNAME=null where ZYXB=''90000000000'' update T_STAT_CF_FQJFHZ set XM=null where XM=''-1'' update T_STAT_CF_FQJFHZ set SZ=null where SZ=''9000''', N'1', N'select XIANNAME,XIANGNAME,CUNNAME,case substring(LBNAME,1,1) when ''0'' then substring(LBNAME,2,1) else substring(LBNAME,1,2) end as LBNAME,ISNULL(XBNAME,'''')+CASE WHEN ZYXBNAME IS NULL THEN '''' ELSE ''.'' END+ISNULL(ZYXBNAME,''''),LZNAME,SZNAME,QYNAME,LL,YBD,PJZJ,PJSG,TRGXDJ,GQXJ,CFMJ,CFXJ,CFZS,CCL,JDGXFSNAME,JDGXSZNAME,JDGXSJ from T_STAT_CF_FQJFHZ order by XIANG,CUN,LB,XB,ZYXB,XM,SZ', 5, N'2,3,XIANNAME;', 1, 2013, 1, N'')
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'CF', 1, N'择伐、渐伐、抚育采伐伐区调查设计汇总表', N'T_STAT_CF_FQCF', N'CREATE TABLE [T_STAT_CF_FQCF]([TBDW] [nvarchar](50) NULL,[XIAN] [nvarchar](7) NULL,[XIANNAME] [nvarchar](50) NULL,[XIANG] [nvarchar](10) NULL,[XIANGNAME] [nvarchar](50) NULL,[CUN] [nvarchar](13) NULL,[CUNNAME] [nvarchar](50) NULL,[LB] [nvarchar](5) NULL,[LBNAME] [nvarchar](5) NULL,[XB] [nvarchar](5) NULL,[XBNAME] [nvarchar](5) NULL,[ZYXB] [nvarchar](11) NULL,[ZYXBNAME] [nvarchar](11) NULL,[XM] [nvarchar](50) NULL,[QY] [smallint] NULL,[QYNAME] [nvarchar](50) NULL,[LZ] [nvarchar](50) NULL,[LZNAME] [nvarchar](50) NULL,[SZ] [nvarchar](50) NULL,[SZNAME] [nvarchar](50) NULL,[LL] [smallint] NULL,[YBD] [numeric](38, 1) NULL,[PJZJ] [numeric](38, 1) NULL,[PJSG] [numeric](38, 1) NULL,[TRGXDJ] [nvarchar](1) NULL,[TRGXDJNAME] [nvarchar](50) NULL,[GQXJCF] [numeric](38, 1) NULL,[GQXJBL] [numeric](38, 1) NULL,[GQZSCF] [numeric](38, 1) NULL,[GQZSBL] [numeric](38, 1) NULL,[CFLX] [nvarchar](2) NULL,[CFLXNAME] [nvarchar](50) NULL,[CFQDXJ] [numeric](38, 2) NULL,[CFQDZS] [numeric](38, 2) NULL,[XBMJ] [numeric](38, 2) NULL,[CFMJ] [numeric](38, 2) NULL,[CFZS] [numeric](38, 0) NULL,[CFXJ] [numeric](38, 0) NULL,[CFCCJ] [numeric](38, 4) NULL) ON [PRIMARY]', N'SP_STAT_CF_FQCF', N'Create PROCEDURE [SP_STAT_CF_FQCF](@tj nvarchar(max)) AS declare @year varchar(4) declare yearcursor cursor for select top 1 reportyear from t_stat_report open yearcursor fetch next from yearcursor into @year close yearcursor DEALLOCATE yearcursor delete from T_STAT_CF_FQCF exec(''insert into T_STAT_CF_FQCF(XIANG,CUN,LB,XB,ZYXB,XM,SZ,PJZJ,PJSG,GQXJCF,GQXJBL,GQZSCF,GQZSBL,CFQDXJ,CFQDZS,CFMJ,CFZS,CFXJ,CFCCJ) select case GROUPING(XIANG) when 1 then ''''9000000000'''' else XIANG end as XIANG,case GROUPING(cun) when 1 then ''''9000000000000'''' else cun end AS CUN,case GROUPING(LIN_BAN) when 1 then ''''90000'''' else LIN_BAN end AS LIN_BAN,case GROUPING(XIAO_BAN) when 1 then ''''90000'''' else XIAO_BAN end AS XIAO_BAN,case grouping(XI_BAN) when 1 then ''''90000000000'''' else XI_BAN end AS XI_BAN,case GROUPING(LMSYZXM) when 1 then ''''-1'''' else LMSYZXM end AS LMSYZXM,case GROUPING(sz) when 1 then ''''9000'''' else sz end AS SZ,SUM(PINGJUN_XJ),SUM(PINGJUN_SG),SUM(gqcfxj),SUM(BLMGQXJ),SUM(gqcfzs),SUM(BLMGQZS),SUM(cfqdxj),SUM(cfqdzs),SUM(CFMJ),SUM(cfzs),SUM(cfxj),SUM(CCL) from (SELECT XIANG,CUN,CASE LTRIM(LIN_BAN) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE LIN_BAN END AS LIN_BAN,CASE LTRIM(XIAO_BAN) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE XIAO_BAN END AS XIAO_BAN,CASE LTRIM(XI_BAN) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE XI_BAN END AS XI_BAN,case ltrim(LMSYZXM) when '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE LMSYZXM END AS LMSYZXM,CASE LTRIM(YOU_SHI_SZ) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE YOU_SHI_SZ END AS sz,PINGJUN_XJ,PINGJUN_SG,CFXJ/case CFMJ when 0 then null else CFMJ end as gqcfxj,BLMGQXJ,cast(CFZS as numeric(38,1))/case CFMJ when 0 then null else CFMJ end as gqcfzs,BLMGQZS,CFXJ*100/case ZXJ when 0 then null else ZXJ end as cfqdxj,cast(CFZS AS numeric(38,1))*100/case FQZS when 0 then null else FQZS end as cfqdzs,MIAN_JI,CFMJ,CFXJ,CFZS,nullif(GGCCCL,0)+nullif(FGGCCCL,0) as CCL from ZT_CF_''+@year+'' WHERE ''+@tj+'' and (CFFS=''''12'''' OR CFFS=''''13'''' OR CFFS=''''21''''))A group by XIANG,CUN,LIN_BAN,XIAO_BAN,XI_BAN,LMSYZXM,sz with rollup order by XIANG,CUN,LIN_BAN,XIAO_BAN,XI_BAN,LMSYZXM,SZ'') DELETE FROM T_STAT_CF_FQCF WHERE SZ=''9000'' AND (XM!=''-1'' or XM IS NULL) DELETE FROM T_STAT_CF_FQCF WHERE XM=''-1'' AND ZYXB&lt;''90000000000'' DELETE FROM T_STAT_CF_FQCF WHERE ZYXB=''90000000000'' AND XB&lt;''90000''  update T_STAT_CF_FQCF set PJZJ=null,PJSG=null,GQXJCF=null,GQXJBL=null,GQZSCF=null,GQZSBL=null where ZYXB=''90000000000'' exec(''update a set a.XIAN=b.XIAN from T_STAT_CF_FQCF a inner join ZT_CF_''+@year+'' b on ISNULL(a.XIANG,''''0'''')=ISNULL(b.XIANG,''''0'''')'') exec(''update T_STAT_CF_FQCF set QY=b.QI_YUAN,LZ=b.LIN_ZHONG,LL=b.PINGJUN_NL,YBD=b.YU_BI_DU,TRGXDJ=b.GXDJ,CFLX=b.CFLX,XBMJ=b.MIAN_JI from T_STAT_CF_FQCF a inner join ZT_CF_''+@year+'' b on ISNULL(a.XIANG,''''0'''')=ISNULL(b.XIANG,''''0'''') where ISNULL(a.CUN,''''0'''')=ISNULL(b.CUN,''''0'''') and ISNULL(a.LB,''''0'''')=ISNULL(b.LIN_BAN,''''0'''') and ISNULL(a.XB,''''0'''')=ISNULL(b.XIAO_BAN,''''0'''') and ISNULL(a.ZYXB,''''0'''')=ISNULL(b.XI_BAN,''''0'''') and ISNULL(a.XM,''''0'''')=ISNULL(b.LMSYZXM,''''0'''') and ISNULL(a.SZ,''''0'''')=ISNULL(b.YOU_SHI_SZ,''''0'''')'') update T_STAT_CF_FQCF set XIANNAME=XIAN,XIANGNAME=XIANG,CUNNAME=CUN,LBNAME=LB,XBNAME=XB,ZYXBNAME=ZYXB,QYNAME=QY,LZNAME=LZ,SZNAME=SZ,TRGXDJNAME=TRGXDJ,CFLXNAME=CFLX update T_STAT_CF_FQCF set XIANNAME=(select cname from t_sys_meta_code b where XIAN=b.CCODE and b.cindex=''103''),XIANGNAME=(select cname from t_sys_meta_code b where XIANG=b.CCODE and b.cindex=''104''),CUNNAME=(select cname from t_sys_meta_code b where cun=b.CCODE and b.cindex=''105''),QYNAME=(select cname from t_sys_meta_code b where qy=b.CCODE and b.CINDEX=''213''),LZNAME=(select cname from t_sys_meta_code b where lz=b.ccode and b.CINDEX=''212''),SZNAME=(select cname from t_sys_meta_code b where sz=b.ccode and b.CINDEX=''219''),TRGXDJNAME=(select cname from t_sys_meta_code b where TRGXDJ=b.ccode and b.cindex=''251''),CFLXNAME=(select cname from t_sys_meta_code b where CFLX=b.ccode and b.cindex=''273'') update T_STAT_CF_FQCF set XBNAME=''林班合计'' where XB=''90000'' update T_STAT_CF_FQCF set LBNAME=''合计'',XBNAME=null where LB=''90000'' update T_STAT_CF_FQCF set CUNNAME=''合计'',LBNAME=null,XBNAME=null where CUN=''9000000000000'' update T_STAT_CF_FQCF set XIANGNAME=''总合计'',CUNNAME=null,LBNAME=null,XBNAME=null where XIANG=''9000000000'' update T_STAT_CF_FQCF set ZYXBNAME=null where ZYXB=''90000000000'' update T_STAT_CF_FQCF set XM=null where XM=''-1'' update T_STAT_CF_FQCF set SZ=null where SZ=''9000''', N'1', N'select TBDW,XIANGNAME,CUNNAME,case substring(LBNAME,1,1) when ''0'' then substring(LBNAME,2,1) else substring(LBNAME,1,2) end as LBNAME,ISNULL(XBNAME,'''')+CASE WHEN ZYXBNAME IS NULL THEN '''' ELSE ''.'' END+ISNULL(ZYXBNAME,''''),LZNAME,SZNAME,QYNAME,LL,YBD,PJZJ,PJSG,TRGXDJNAME,GQXJCF,GQXJBL,GQZSCF,GQZSBL,CFQDXJ,CFQDZS,CFMJ,CFXJ,CFZS,CFCCJ from T_STAT_CF_FQCF order by XIANG,CUN,LB,XB,ZYXB,XM,SZ', 6, N'2,2,TBDW;', 1, 2013, 1, NULL)
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'CF', 2, N'林木每公顷蓄积量和出材量统计表', N'T_STAT_CF_LMXJCC', N'CREATE TABLE [T_STAT_CF_LMXJCC]([XIAN] [numeric](6, 0) NULL,[XIANNAME] [nvarchar](6) NULL,[XIANG] [numeric](9, 0) NULL,[XIANGNAME] [nvarchar](9) NULL,[CUN] [numeric](12, 0) NULL,[CUNNAME] [nvarchar](12) NULL,[LB] [numeric](4, 0) NULL,[LBNAME] [nvarchar](4) NULL,[DCB] [numeric](4, 0) NOT NULL,[DCBNAME] [nvarchar](4) NULL,[ZYXB] [nvarchar](10) NULL,[ZYXBNAME] [nvarchar](10) NULL,[BZDH] [numeric](38, 0) NULL,[BZMJ] [numeric](38, 2) NULL,[SZ] [nvarchar](6) NULL,[SZNAME] [nvarchar](50) NULL,[JJ] [nvarchar](4) NULL,[JCLX] [numeric](1, 0) NULL,[JCLXNAME] [nvarchar](4) NULL,[PJXJ] [numeric](38, 1) NULL,[PJSG] [numeric](38, 1) NULL,[YCSJCZS] [numeric](38, 0) NULL,[BYCSJCZS] [numeric](38, 0) NULL,[XCSJCZS] [numeric](38, 0) NULL,[YCSXJL] [numeric](38, 3) NULL,[BYCSXJL] [numeric](38, 3) NULL,[XCSXJL] [numeric](38, 3) NULL,[GGCCCLV] [numeric](38, 2) NULL,[XCCCLV] [numeric](38, 2) NULL,[GGCCCL] [numeric](38, 4) NULL,[XCCCL] [numeric](38, 4) NULL,[PARAMS] [smallint] NULL) ON [PRIMARY]', N'SP_STAT_CF_LMXJCC', N'create PROCEDURE [SP_STAT_CF_LMXJCC](@tj nvarchar(max)) AS declare @year varchar(4) declare yearcursor cursor for select top 1 reportyear from t_stat_report open yearcursor fetch next from yearcursor into @year close yearcursor DEALLOCATE yearcursor delete from T_STAT_CF_LMXJCC EXEC(''insert into T_STAT_CF_LMXJCC(XIAN,XIANNAME,XIANG,XIANGNAME,CUN,CUNNAME,LB,LBNAME,DCB,DCBNAME,ZYXB,ZYXBNAME,BZDH,bzmj,SZ,SZNAME,JJ,JCLX,JCLXNAME,PJXJ,PJSG,YCSJCZS,BYCSJCZS,XCSJCZS,YCSXJL,BYCSXJL,XCSXJL,GGCCCLV,XCCCLV,GGCCCL,XCCCL,PARAMS) select c.xian,c.xianname,c.xiang,c.xiangname,a.cun,(select cname from t_sys_meta_code b where a.cun=b.CCODE and b.cindex=''''105''''),LIN_BAN,LIN_BAN,DCXB,DCXB,ZYXB,ZYXB,BZDH,BZDMJ,JCSZ,(select cname from t_sys_meta_code b where jcsz=b.CCODE and b.cindex=''''219''''),JJ,JCLX,(select cname from t_sys_meta_code b where JCLX=b.CCODE and b.cindex=''''255''''),PJZJ,PJG,YCZS,BYCZS,XCZS,YCXJ,BYCXJ,XCXJ,GGCCCLV,XCCCLV,GGCCCL,XCCCL,0 FROM T_ZT_CF_MMJC a inner join (select XIAN,xiang,cun,(select cname from t_sys_meta_code b where XIAN=b.CCODE and b.cindex=''''103'''') as xianname,(select cname from t_sys_meta_code b where XIANG=b.CCODE and b.cindex=''''104'''') as xiangname from ZT_CF_''+@YEAR+'' where ''+@tj+'' group by xian,xiang,cun)c on a.cun=c.cun'') insert into T_STAT_CF_LMXJCC(xian,XIANNAME,xiang,XIANGNAME,cun,CUNNAME,LB,lbname,DCB,dcbname,ZYXB,zyxbname,BZDH,BZMJ,SZ,JJ,JCLXNAME,YCSJCZS,YCSXJL,GGCCCL,XCCCL,PARAMS) select xian,XIANNAME,xiang,XIANGNAME,cun,CUNNAME,LB,lbname,DCB,dcbname,ZYXB,zyxbname,BZDH,BZMJ,sz,''合计'',(select cname from t_sys_meta_code b where JCLX=b.CCODE and b.cindex=''255''),SUM(YCSJCZS),sum(YCSXJL),sum(GGCCCL),sum(XCCCL),1 from T_STAT_CF_LMXJCC group by xian,xianname,XIANg,xiangname,CUN,cunname,LB,lbname,DCB,dcbname,ZYXB,zyxbname,BZDH,BZMJ,SZ,JCLX insert into T_STAT_CF_LMXJCC(XIAN,XIANNAME,xiang,XIANGNAME,cun,CUNNAME,LB,lbname,DCB,dcbname,ZYXB,zyxbname,BZDH,SZ,JJ,JCLXNAME,YCSXJL,GGCCCL,XCCCL,PARAMS) select xian,XIANNAME,xiang,XIANGNAME,cun,CUNNAME,LB,lbname,DCB,dcbname,ZYXB,zyxbname,BZDH,sz,''公顷'',JCLXNAME,YCSXJL*10000/case bzmj when 0 then null else bzmj end,GGCCCL*10000/case bzmj when 0 then null else bzmj end,XCCCL*10000/case bzmj when 0 then null else bzmj end,2 from T_STAT_CF_LMXJCC where PARAMS=1 insert into T_STAT_CF_LMXJCC(xian,XIANNAME,xiang,XIANGNAME,cun,CUNNAME,LB,lbname,DCB,dcbname,ZYXB,zyxbname,BZDH,BZMJ,PARAMS) select xian,XIANNAME,xiang,XIANGNAME,cun,CUNNAME,LB,lbname,DCB,dcbname,ZYXB,zyxbname,BZDH,BZMJ,3 from T_STAT_CF_LMXJCC where params=0 group by xian,XIANNAME,xiang,XIANGNAME,cun,CUNNAME,LB,lbname,DCB,dcbname,ZYXB,zyxbname,BZDH,BZMJ', N'1', N'select XIANNAME,XIANGNAME,CUNNAME,case substring(LBNAME,1,1) when ''0'' then substring(LBNAME,2,1) else substring(LBNAME,1,2) end as LBNAME,ISNULL(DCBNAME,'''')+CASE WHEN ZYXBNAME IS NULL THEN '''' ELSE ''.'' END+ISNULL(ZYXBNAME,'''') AS DCBNAME,BZDH,BZMJ,SZNAME,JJ,JCLXNAME,CAST(PJXJ AS numeric(38,1)),CAST(PJSG AS numeric(38,1)),ISNULL(YCSJCZS,0)+ISNULL(BYCSJCZS,0)+ISNULL(XCSJCZS,0),YCSJCZS,BYCSJCZS,XCSJCZS,ISNULL(YCSXJL,0)+ISNULL(BYCSXJL,0)+ISNULL(XCSXJL,0),YCSXJL,BYCSXJL,XCSXJL,(ISNULL(GGCCCL,0)+ISNULL(XCCCL,0))/0.01,ISNULL(GGCCCL,0)+ISNULL(XCCCL,0),PARAMS from T_STAT_CF_LMXJCC order by xian,xiang,cun,lb,dcb,zyxb,bzdh,sz,PARAMS', 6, N'2,1,XIANNAME;2,4,XIANGNAME;2,6,CUNNAME;2,8,LBNAME;2,10,DCBNAME;2,12,bzdh;2,15,bzmj;', 7, 2013, 1, N'2')
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'SF', 4, N'森林火灾登记表', NULL, NULL, NULL, NULL, N'0', N'select DIMING,CONVERT(varchar(2),month(QHSJ))+'' 月 ''+CONVERT(varchar(2),day(QHSJ))+'' 日 '' as qhsjyr,CONVERT(varchar(2),datepart(hh,QHSJ))+'' 时 ''+CONVERT(varchar(2),datepart(mi,QHSJ))+'' 分 '' as qhsjsf,CONVERT(varchar(2),month(PHSJ))+'' 月 ''+CONVERT(varchar(2),day(PHSJ))+'' 日 '' as phsjyr,CONVERT(varchar(2),datepart(hh,PHSJ))+'' 时 ''+CONVERT(varchar(2),datepart(mi,PHSJ))+'' 分 '' as qhsjsf,(select cname from t_sys_meta_code b where a.HZYY=b.CCODE and CINDEX=''264'') as HZYY,TOTAL_MJ,isnull(YSL_MJ,0)+isnull(RGL_MJ,0) as HZZMJ,YSL_MJ,RGL_MJ,LINFEN,NL,SS_CL,SS_YL,SS_ZLMJ,SHANG_Q,SHANG_Z,SHANG_S,SS_MONEY,PU_RG,PU_CL,PU_QC,PU_FJ,PU_JF,SF_CL,CL_RS,CL_XSRS  from T_ZT_HZ_INFO a union select ''校验性合计'',''全年火灾总起数= ''+str(COUNT(1),4)+''  (起)'','''','''','''','''',sum(TOTAL_MJ),sum(isnull(YSL_MJ,0)+isnull(RGL_MJ,0)) as HZZMJ,sum(YSL_MJ),sum(RGL_MJ),'''','''',sum(SS_CL),sum(SS_YL),sum(SS_ZLMJ),sum(SHANG_Q),sum(SHANG_Z),sum(SHANG_S),sum(SS_MONEY),sum(PU_RG),sum(PU_CL),sum(PU_QC),sum(PU_FJ),sum(PU_JF),'''',sum(CL_RS),sum(CL_XSRS)  from T_ZT_HZ_INFO a', 5, NULL, 0, 2013, 0, NULL)
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'SF', 0, N'森林火灾每月统计表', N'T_STAT_SF_HZ', N'CREATE TABLE [T_STAT_SF_HZ]([DM] [bigint] NULL,[DMANME] [nvarchar](50) NULL,[YUEFEN] [int] NULL,[HZCSJ] [int] NULL,[YBHZ] [int] NULL,[JDHZ] [int] NULL,[ZDHZ] [int] NULL,[TDHZ] [int] NULL,[HCZMJ] [numeric](38, 2) NULL,[SHMJJ] [numeric](38, 2) NULL,[YSL] [numeric](38, 2) NULL,[RGL] [numeric](38, 2) NULL,[CLXJ] [numeric](38, 3) NULL,[YLZS] [numeric](38, 4) NULL,[RYSWJ] [int] NULL,[QS] [int] NULL,[ZS] [int] NULL,[SW] [int] NULL,[QTSS] [numeric](38, 4) NULL,[PHRG] [int] NULL,[CLJ] [int] NULL,[QC] [int] NULL,[FJ] [int] NULL,[JF] [numeric](38, 4) NULL) ON [PRIMARY]', N'SP_STAT_SF_HZ', N'CREATE PROCEDURE [SP_STAT_SF_HZ]  AS   delete from T_STAT_SF_HZ;   insert into  T_STAT_SF_HZ(DM,YUEFEN,SHMJJ,YSL,RGL,CLXJ,YLZS,QS,ZS,SW,QTSS,PHRG,CLJ,QC,FJ,JF)   select XIANG,yuefen,sum(TOTAL_MJ),SUM(YSL_MJ),SUM(RGL_MJ),SUM(SS_CL),SUM(SS_YL),sum(SHANG_Q),SUM(SHANG_Z),SUM(SHANG_S),SUM(SS_MONEY),  SUM(PU_RG),SUM(PU_CL),sum(PU_QC),SUM(PU_FJ),SUM(PU_JF) from  (select XIANG,MONTH(QHSJ) as yuefen,TOTAL_MJ,YSL_MJ,RGL_MJ,SS_CL,SS_YL,SHANG_Q,SHANG_Z,SHANG_S,SS_MONEY,PU_RG,PU_CL,PU_QC,PU_FJ,PU_JF from T_ZT_HZ_INFO)a  group by XIANG,yuefen order by XIANG,yuefen  update a set a.YBHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=1)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update a set a.JDHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=2)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update a set a.ZDHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=3)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update a set a.TDHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=4)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update T_STAT_SF_HZ set HZCSJ=isnull(YBHZ,0)+isnull(JDHZ,0)+isnull(ZDHZ,0)+isnull(TDHZ,0),RYSWJ=isnull(QS,0)+isnull(ZS,0)+isnull(SW,0)  update T_STAT_SF_HZ set DMANME=(select cname from t_sys_meta_code b where DM=b.CCODE and b.cindex=''104'')', N'1', N'select ''1'',''一月至本月合计'',SUM(HZCSJ),SUM(YBHZ),SUM(JDHZ),SUM(ZDHZ),SUM(TDHZ),SUM(HCZMJ),SUM(SHMJJ),SUM(YSL),SUM(RGL),SUM(CLXJ),SUM(YLZS),SUM(RYSWJ),  sum(QS),sum(ZS),sum(SW),sum(QTSS),sum(PHRG),sum(CLJ),sum(QC),sum(FJ),sum(JF) from T_STAT_SF_HZ where YUEFEN&lt;=12 union  select ''2'',''本月合计'',SUM(HZCSJ),SUM(YBHZ),SUM(JDHZ),SUM(ZDHZ),SUM(TDHZ),SUM(HCZMJ),SUM(SHMJJ),SUM(YSL),SUM(RGL),SUM(CLXJ),SUM(YLZS),SUM(RYSWJ),  sum(QS),sum(ZS),sum(SW),sum(QTSS),sum(PHRG),sum(CLJ),sum(QC),sum(FJ),sum(JF) from T_STAT_SF_HZ where yuefen&lt;=12 union  select DM,DMANME,HZCSJ,YBHZ,JDHZ,ZDHZ,TDHZ,HCZMJ,SHMJJ,YSL,RGL,CLXJ,YLZS,RYSWJ,QS,ZS,SW,QTSS,PHRG,CLJ,QC,FJ,JF from T_STAT_SF_HZ where yuefen&lt;=12 order by 1 asc', 8, NULL, 1, 2013, 1, NULL)
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'SF', 1, N'森林火灾分月统计表', N'T_STAT_SF_HZ', N'CREATE TABLE [T_STAT_SF_HZ]([DM] [bigint] NULL,[DMANME] [nvarchar](50) NULL,[YUEFEN] [int] NULL,[HZCSJ] [int] NULL,[YBHZ] [int] NULL,[JDHZ] [int] NULL,[ZDHZ] [int] NULL,[TDHZ] [int] NULL,[HCZMJ] [numeric](38, 2) NULL,[SHMJJ] [numeric](38, 2) NULL,[YSL] [numeric](38, 2) NULL,[RGL] [numeric](38, 2) NULL,[CLXJ] [numeric](38, 3) NULL,[YLZS] [numeric](38, 4) NULL,[RYSWJ] [int] NULL,[QS] [int] NULL,[ZS] [int] NULL,[SW] [int] NULL,[QTSS] [numeric](38, 4) NULL,[PHRG] [int] NULL,[CLJ] [int] NULL,[QC] [int] NULL,[FJ] [int] NULL,[JF] [numeric](38, 4) NULL) ON [PRIMARY]', N'SP_STAT_SF_HZ', N'CREATE PROCEDURE [SP_STAT_SF_HZ]  AS   delete from T_STAT_SF_HZ;   insert into  T_STAT_SF_HZ(DM,YUEFEN,SHMJJ,YSL,RGL,CLXJ,YLZS,QS,ZS,SW,QTSS,PHRG,CLJ,QC,FJ,JF)   select XIANG,yuefen,sum(TOTAL_MJ),SUM(YSL_MJ),SUM(RGL_MJ),SUM(SS_CL),SUM(SS_YL),sum(SHANG_Q),SUM(SHANG_Z),SUM(SHANG_S),SUM(SS_MONEY),  SUM(PU_RG),SUM(PU_CL),sum(PU_QC),SUM(PU_FJ),SUM(PU_JF) from  (select XIANG,MONTH(QHSJ) as yuefen,TOTAL_MJ,YSL_MJ,RGL_MJ,SS_CL,SS_YL,SHANG_Q,SHANG_Z,SHANG_S,SS_MONEY,PU_RG,PU_CL,PU_QC,PU_FJ,PU_JF from T_ZT_HZ_INFO)a  group by XIANG,yuefen order by XIANG,yuefen  update a set a.YBHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=1)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update a set a.JDHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=2)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update a set a.ZDHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=3)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update a set a.TDHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=4)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update T_STAT_SF_HZ set HZCSJ=isnull(YBHZ,0)+isnull(JDHZ,0)+isnull(ZDHZ,0)+isnull(TDHZ,0),RYSWJ=isnull(QS,0)+isnull(ZS,0)+isnull(SW,0)  update T_STAT_SF_HZ set DMANME=(select cname from t_sys_meta_code b where DM=b.CCODE and b.cindex=''104'')', N'1', N'select yuefen,case yuefen when 0 then ''全年累计'' when 1 then ''一月'' when 2 then ''二月'' when 3 then ''三月'' when 4 then ''四月'' when 5 then ''五月'' when 6 then ''六月'' when 7 then ''七月'' when 8 then ''八月'' when 9 then ''九月'' when 10 then ''十月'' when 11 then ''十一月'' when 12 then ''十二月'' end as yuefenname,hzcsj,ybhz,jdhz,zdhz,tdhz,hczmj,shmjj,ysl,rgl,clxj,ylzs,ryswj,qs,zs,sw,qtss,phrg,clj,qc,fj,jf from (select case GROUPING(yuefen) when 1 then 0 else YUEFEN end as yuefen,SUM(HZCSJ) as hzcsj,SUM(YBHZ) as ybhz,SUM(JDHZ) as jdhz,SUM(ZDHZ) as zdhz,SUM(TDHZ) as tdhz,SUM(HCZMJ) as hczmj,SUM(SHMJJ) as shmjj,SUM(YSL) as ysl,SUM(RGL) as rgl,SUM(CLXJ) as clxj,SUM(YLZS) as ylzs,SUM(RYSWJ) as ryswj, sum(QS) as qs,sum(ZS) as zs,sum(SW) as sw,sum(QTSS) as qtss,sum(PHRG) as phrg,sum(CLJ) as clj,sum(QC) as qc,sum(FJ) as fj,sum(JF) as jf from T_STAT_SF_HZ group by YUEFEN with rollup)a order by YUEFEN ', 8, NULL, 1, 2013, 1, NULL)
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'SF', 2, N'森林火灾分地区统计表', N'T_STAT_SF_HZ', N'CREATE TABLE [T_STAT_SF_HZ]([DM] [bigint] NULL,[DMANME] [nvarchar](50) NULL,[YUEFEN] [int] NULL,[HZCSJ] [int] NULL,[YBHZ] [int] NULL,[JDHZ] [int] NULL,[ZDHZ] [int] NULL,[TDHZ] [int] NULL,[HCZMJ] [numeric](38, 2) NULL,[SHMJJ] [numeric](38, 2) NULL,[YSL] [numeric](38, 2) NULL,[RGL] [numeric](38, 2) NULL,[CLXJ] [numeric](38, 3) NULL,[YLZS] [numeric](38, 4) NULL,[RYSWJ] [int] NULL,[QS] [int] NULL,[ZS] [int] NULL,[SW] [int] NULL,[QTSS] [numeric](38, 4) NULL,[PHRG] [int] NULL,[CLJ] [int] NULL,[QC] [int] NULL,[FJ] [int] NULL,[JF] [numeric](38, 4) NULL) ON [PRIMARY]', N'SP_STAT_SF_HZ', N'CREATE PROCEDURE [SP_STAT_SF_HZ]  AS   delete from T_STAT_SF_HZ;   insert into  T_STAT_SF_HZ(DM,YUEFEN,SHMJJ,YSL,RGL,CLXJ,YLZS,QS,ZS,SW,QTSS,PHRG,CLJ,QC,FJ,JF)   select XIANG,yuefen,sum(TOTAL_MJ),SUM(YSL_MJ),SUM(RGL_MJ),SUM(SS_CL),SUM(SS_YL),sum(SHANG_Q),SUM(SHANG_Z),SUM(SHANG_S),SUM(SS_MONEY),  SUM(PU_RG),SUM(PU_CL),sum(PU_QC),SUM(PU_FJ),SUM(PU_JF) from  (select XIANG,MONTH(QHSJ) as yuefen,TOTAL_MJ,YSL_MJ,RGL_MJ,SS_CL,SS_YL,SHANG_Q,SHANG_Z,SHANG_S,SS_MONEY,PU_RG,PU_CL,PU_QC,PU_FJ,PU_JF from T_ZT_HZ_INFO)a  group by XIANG,yuefen order by XIANG,yuefen  update a set a.YBHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=1)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update a set a.JDHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=2)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update a set a.ZDHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=3)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update a set a.TDHZ=b.sl from T_STAT_SF_HZ a inner join (select XIANG,yuefen,HZDJ,COUNT(1) as sl from (select XIANG,MONTH(QHSJ) as yuefen,HZDJ from T_ZT_HZ_INFO where HZDJ=4)c group by XIANG,yuefen,HZDJ)b   on a.DM=b.XIANG and a.YUEFEN=b.yuefen  update T_STAT_SF_HZ set HZCSJ=isnull(YBHZ,0)+isnull(JDHZ,0)+isnull(ZDHZ,0)+isnull(TDHZ,0),RYSWJ=isnull(QS,0)+isnull(ZS,0)+isnull(SW,0)  update T_STAT_SF_HZ set DMANME=(select cname from t_sys_meta_code b where DM=b.CCODE and b.cindex=''104'')', N'1', N'select case dm when 0 then ''全年累计'' else (select CNAME from T_SYS_META_CODE b where a.dm=b.CCODE and b.cindex=''104'') end as dm,hzcsj,ybhz,jdhz,zdhz,tdhz,hczmj,shmjj,ysl,rgl,clxj,ylzs,ryswj,qs,zs,sw,qtss,phrg,clj,qc,fj,jf from (select case GROUPING(DM) when 1 then 0 else dm end as dm,SUM(HZCSJ) as hzcsj,SUM(YBHZ) as ybhz,SUM(JDHZ) as jdhz,SUM(ZDHZ) as zdhz,SUM(TDHZ) as tdhz,SUM(HCZMJ) as hczmj,SUM(SHMJJ) as shmjj,SUM(YSL) as ysl,SUM(RGL) as rgl,SUM(CLXJ) as clxj,SUM(YLZS) as ylzs,SUM(RYSWJ) as ryswj, sum(QS) as qs,sum(ZS) as zs,sum(SW) as sw,sum(QTSS) as qtss,sum(PHRG) as phrg,sum(CLJ) as clj,sum(QC) as qc,sum(FJ) as fj,sum(JF) as jf from T_STAT_SF_HZ group by dm with rollup)a order by a.dm asc', 8, NULL, 0, 2013, 1, NULL)
INSERT [dbo].[T_STAT_REPORT] ([Theme], [ReportID], [ReportName], [DataTable], [TableSql], [StoredProcedure], [StoredProcedureSql], [UseStoredProcedure], [StaticSQL], [StartIndex], [GroupIndex], [DtColIndex], [reportyear], [IsShow], [MergeColIndex]) VALUES (N'CF', 4, N'择伐、渐伐、抚育采伐林分变化情况表', N'T_STAT_CF_LFBH', N'CREATE TABLE [T_STAT_CF_LFBH]([TBDW] [nvarchar](50) NULL,[XIAN] [nvarchar](7) NULL,[XIANNAME] [nvarchar](50) NULL,[XIANG] [nvarchar](10) NULL,[XIANGNAME] [nvarchar](50) NULL,[CUN] [nvarchar](13) NULL,[CUNNAME] [nvarchar](50) NULL,[LB] [nvarchar](5) NULL,[LBNAME] [nvarchar](5) NULL,[XB] [nvarchar](5) NULL,[XBNAME] [nvarchar](5) NULL,[ZYXB] [nvarchar](11) NULL,[ZYXBNAME] [nvarchar](11) NULL,[SZ] [nvarchar](4) NULL,[SZNAME] [nvarchar](50) NULL,[CFLX] [nvarchar](2) NULL,[CFLXNAME] [nvarchar](50) NULL,[CFQDZS] [numeric](38, 0) NULL,[CFQDXJ] [numeric](38, 1) NULL,[SMDFQ] [numeric](38, 1) NULL,[SMDFH] [numeric](38, 1) NULL,[PJXJFQ] [numeric](38, 1) NULL,[PJXJFH] [numeric](38, 1) NULL,[PJSGFQ] [numeric](38, 1) NULL,[PJSGFH] [numeric](38, 1) NULL,[GQXJFQ] [numeric](38, 1) NULL,[GQXJFH] [numeric](38, 1) NULL,[GQZSFQ] [numeric](38, 0) NULL,[GQZSFH] [numeric](38, 0) NULL) ON [PRIMARY]', N'SP_STAT_CF_LFBH', N'Create PROCEDURE [SP_STAT_CF_LFBH](@tj nvarchar(max)) AS declare @year varchar(4) declare yearcursor cursor for select top 1 reportyear from t_stat_report open yearcursor fetch next from yearcursor into @year close yearcursor DEALLOCATE yearcursor delete from T_STAT_CF_LFBH exec(''insert into T_STAT_CF_LFBH(XIANG,CUN,LB,XB,ZYXB,SZ,CFQDZS,CFQDXJ,SMDFQ,PJXJFQ,PJSGFQ,GQXJFQ,GQZSFQ) select case GROUPING(XIANG) when 1 then ''''9000000000'''' else XIANG end as XIANG,case GROUPING(cun) when 1 then ''''9000000000000'''' else cun end as cun,case GROUPING(LIN_BAN) when 1 then ''''90000'''' else LIN_BAN end as LIN_BAN,case GROUPING(XIAO_BAN) when 1 then ''''90000'''' else XIAO_BAN end as XIAO_BAN,case grouping(XI_BAN) when 1 then ''''90000000000'''' else XI_BAN end as XI_BAN,case grouping(SZ) when 1 then ''''9000'''' else SZ end as SZ,SUM(cfqdzs),SUM(round(cfqdxj,1)),SUM(YU_BI_DU),SUM(round(PINGJUN_XJ,1)),SUM(round(PINGJUN_SG,1)),SUM(round(HUO_LMGQXJ,1)),SUM(MEI_GQ_ZS) from (SELECT XIANG,CUN,CASE LTRIM(LIN_BAN) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE LIN_BAN END AS LIN_BAN,CASE LTRIM(XIAO_BAN) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE XIAO_BAN END AS XIAO_BAN,CASE LTRIM(XI_BAN) WHEN '''''''' THEN ''''0'''' WHEN NULL THEN ''''0'''' ELSE XI_BAN END AS XI_BAN,you_shi_sz AS SZ,cast(CFZS AS numeric(38,1))*100/case fqzs when 0 then null else fqzs end as cfqdzs,cast(CFXJ AS numeric(38,1))*100/case zxj when 0 then null else zxj end as cfqdxj,YU_BI_DU,PINGJUN_XJ,PINGJUN_SG,HUO_LMGQXJ,MEI_GQ_ZS from ZT_CF_''+@year+'' WHERE ''+@tj+'' and (CFFS=''''12'''' OR CFFS=''''13'''' OR CFFS=''''21''''))A group by XIANG,CUN,LIN_BAN,XIAO_BAN,XI_BAN,SZ with rollup order by XIANG,CUN,LIN_BAN,XIAO_BAN,XI_BAN,SZ'') DELETE FROM T_STAT_CF_LFBH WHERE SZ=''9000'' AND ZYXB&lt;''90000000000'' DELETE FROM T_STAT_CF_LFBH WHERE ZYXB=''90000000000'' AND XB&lt;''90000'' exec(''update a set a.XIAN=b.XIAN from T_STAT_CF_LFBH a inner join ZT_CF_''+@year+'' b on ISNULL(a.XIANG,''''0'''')=ISNULL(b.XIANG,''''0'''')'') exec(''update a set CFLX=B.CFFS from T_STAT_CF_LFBH a inner join ZT_CF_''+@year+'' b on a.XIANG=b.XIANG where ISNULL(a.CUN,''''0'''')=ISNULL(b.CUN,''''0'''') and ISNULL(a.LB,''''0'''')=ISNULL(b.LIN_BAN,''''0'''') and ISNULL(a.XB,''''0'''')=ISNULL(b.XIAO_BAN,''''0'''') and ISNULL(a.ZYXB,''''0'''')=ISNULL(b.XI_BAN,''''0'''') and ISNULL(a.SZ,''''0'''')=ISNULL(b.YOU_SHI_SZ,''''0'''')'') update T_STAT_CF_LFBH set SMDFQ=null,PJXJFQ=null,PJSGFQ=null,GQXJFQ=null,GQZSFQ=null where ZYXB=''90000000000'' update T_STAT_CF_LFBH set XIANNAME=XIAN,XIANGNAME=XIANG,CUNNAME=CUN,LBNAME=LB,XBNAME=XB,ZYXBNAME=ZYXB,SZNAME=SZ,CFLXNAME=CFLX update T_STAT_CF_LFBH set XIANNAME=(select cname from t_sys_meta_code b where XIAN=b.CCODE and b.cindex=''103''),XIANGNAME=(select cname from t_sys_meta_code b where XIANG=b.CCODE and b.cindex=''104''),CUNNAME=(select cname from t_sys_meta_code b where cun=b.CCODE and b.cindex=''105''),SZNAME=(select cname from t_sys_meta_code b where sz=b.ccode and b.CINDEX=''219''),CFLXNAME=(select cname from t_sys_meta_code b where CFLX=b.ccode and b.cindex=''273'') update T_STAT_CF_LFBH set XBNAME=''林班合计'' where XB=''90000'' update T_STAT_CF_LFBH set LBNAME=''合计'',XBNAME=null where LB=''90000'' update T_STAT_CF_LFBH set CUNNAME=''合计'',LBNAME=null,XBNAME=null where CUN=''9000000000000'' update T_STAT_CF_LFBH set XIANGNAME=''总合计'',CUNNAME=null,LBNAME=null,XBNAME=null where XIANG=''9000000000'' update T_STAT_CF_LFBH set ZYXBNAME=null where ZYXB=''90000000000'' update T_STAT_CF_LFBH set SZ=null where SZ=''9000''', N'1', N'select XIANNAME,XIANGNAME,CUNNAME,case substring(LBNAME,1,1) when ''0'' then substring(LBNAME,2,1) else substring(LBNAME,1,2) end as LBNAME,ISNULL(XBNAME,'''')+CASE WHEN ZYXBNAME IS NULL THEN '''' ELSE ''.'' END+ISNULL(ZYXBNAME,''''),SZNAME,CFQDZS,CFQDXJ,SMDFQ,SMDFH,PJXJFQ,PJXJFH,PJSGFQ,PJSGFH,GQXJFQ,GQXJFH,GQZSFQ,GQZSFH from T_STAT_CF_LFBH order by XIANG,CUN,LB,XB,ZYXB,SZ,CFLX', 6, N'2,1,XIANNAME;', 1, 2013, 1, N'1,2,3,4')</value>
  </data>
  <data name="UpdateReport2" xml:space="preserve">
    <value>update T_STAT_REPORT set StoredProcedureSql=Replace(StoredProcedureSql,'GXSJ','GENGXINSJ') WHERE Theme='CF' AND (ReportID=0 OR ReportID=3)
update T_STAT_REPORT set StoredProcedureSql=Replace(StoredProcedureSql,'JDGENGXINSJ','JDGXSJ') WHERE Theme='CF' AND (ReportID=0 OR ReportID=3)
update T_STAT_REPORT set StaticSQL=Replace(StaticSQL,'GXSJ','GENGXINSJ') WHERE Theme='CF' AND (ReportID=0 OR ReportID=3)
update T_STAT_REPORT set StaticSQL=Replace(StaticSQL,'JDGENGXINSJ','JDGXSJ') WHERE Theme='CF' AND (ReportID=0 OR ReportID=3)
UPDATE T_STAT_REPORT SET GroupIndex=Replace(GroupIndex,'GXSJ','GENGXINSJ') WHERE Theme='CF' AND ReportID=3</value>
  </data>
  <data name="DropReport2" xml:space="preserve">
    <value>if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_FQJFSZHZ]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_FQJFSZHZ]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_FQZFSZHZ]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_FQZFSZHZ]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_FQJFHZ]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_FQJFHZ]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_FQCF]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_FQCF]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_LMXJCC]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_LMXJCC]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_LFBH]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_LFBH]</value>
  </data>
  <data name="DropReport" xml:space="preserve">
    <value>if exists (select * from sysobjects where id =object_id(N'[T_STAT_CF_FQJFSZHZ]') and OBJECTPROPERTY(id, N'IsUserTable')= 1) 
drop table [T_STAT_CF_FQJFSZHZ]
if exists (select * from sysobjects where id =object_id(N'[T_STAT_CF_FQZFSZHZ]') and OBJECTPROPERTY(id, N'IsUserTable')= 1) 
drop table [T_STAT_CF_FQZFSZHZ]
if exists (select * from sysobjects where id =object_id(N'[T_STAT_CF_FQJFHZ]') and OBJECTPROPERTY(id, N'IsUserTable')= 1) 
drop table [T_STAT_CF_FQJFHZ]
if exists (select * from sysobjects where id =object_id(N'[T_STAT_CF_FQCF]') and OBJECTPROPERTY(id, N'IsUserTable')= 1) 
drop table [T_STAT_CF_FQCF]
if exists (select * from sysobjects where id =object_id(N'[T_STAT_CF_LMXJCC]') and OBJECTPROPERTY(id, N'IsUserTable')= 1) 
drop table [T_STAT_CF_LMXJCC]
if exists (select * from sysobjects where id =object_id(N'[T_STAT_CF_LFBH]') and OBJECTPROPERTY(id, N'IsUserTable')= 1) 
drop table [T_STAT_CF_LFBH]
if exists (select * from sysobjects where id =object_id(N'[T_STAT_REPORT]') and OBJECTPROPERTY(id, N'IsUserTable')= 1) 
drop table [T_STAT_REPORT]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_FQJFSZHZ]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_FQJFSZHZ]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_FQZFSZHZ]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_FQZFSZHZ]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_FQJFHZ]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_FQJFHZ]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_FQCF]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_FQCF]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_LMXJCC]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_LMXJCC]
if exists (select * from sysobjects where id = object_id(N'[SP_STAT_CF_LFBH]') and OBJECTPROPERTY(id,N'IsProcedure')= 1) 
drop procedure [SP_STAT_CF_LFBH]</value>
  </data>
</root>